qqnorm(lm(share ~ age + pronoun, data = chi_eng )$residuals)
pron_fra %>%
filter(participant == 'CHI') %>%
select(-path) -> chi_fra
qqnorm(lm(share ~ age + pronoun, data = chi_fra )$residuals)
qqnorm(lm(share ~ age + pronoun, data = chi_fra )$residuals)
pron_fra %>%
filter(participant == 'CHI') %>%
select(-path) -> chi_fra
qqnorm(lm(share ~ age + pronoun, data = chi_fra )$residuals)
qqnorm(lm(share ~ age + pronoun, data = chi_fra )$residuals)
child_eng %>%
ggplot(aes(age, share))+
geom_point()+
theme_bw()+
geom_line(data = fortify(fit), aes(x = age, y = .fitted, color = area))
chi_eng %>%
ggplot(aes(age, share))+
geom_point()+
theme_bw()+
geom_line(data = fortify(fit), aes(x = age, y = .fitted, color = area))
chi_eng %>%
ggplot(aes(age, share))+
geom_point()+
theme_bw()+
geom_line(data = fortify(fit), aes(x = age, y = .fitted, color = childname))
adults <- c('MOT',
'FAT', 'DAD',
'INV', 'INT',
'GRA', 'GDM', 'GRM', 'MAM', 'NAN',
'GRN', 'GDF', 'GRF',
'DOC', 'OBS', 'HUS', 'MAN', 'MRS', 'NEI', 'OTH',
'UNC',
'AUN', 'AUT')
eng %>% # take relatively well-represented part (see commet below)
filter(age < 36 & age > 24) %>%
mutate(participant = ifelse(participant %in% adults, 'ADU', participant)) %>%
filter(participant == 'ADU' | participant == 'CHI') -> eng
pron_eng %>%
filter(participant == 'CHI') %>%
select(-path) -> chi_eng
chi_eng %>%
ggplot(aes(age, share))+
geom_point()+
theme_bw()+
geom_line(data = fortify(fit), aes(x = age, y = .fitted, color = childname))
View(pron_eng_merge)
View(pron_ger_merge)
View(pron_eng)
View(pron)
chi_eng %>%
ggplot(aes(age, share))+
geom_point()+
theme_bw()+
geom_line(data = fortify(fit), aes(x = age, y = .fitted))
eng <- read_csv('C:/My/studies/UIT/FLA/code/FLA/result_english_personal.csv')
eng %>% # take relatively well-represented part (see commet below)
filter(age < 36 & age > 24) %>%
mutate(participant = ifelse(participant %in% adults, 'ADU', participant)) %>%
filter(participant == 'ADU' | participant == 'CHI') -> eng
eng %>% # summary
gather('pronoun', 'share', 7:13) -> pron_eng
pron_eng %>%
filter(participant == 'CHI') %>%
select(-path) -> chi_eng
chi_eng %>%
ggplot(aes(age, share))+
geom_point()+
theme_bw()+
geom_line(data = fortify(fit), aes(x = age, y = .fitted))
chi_eng %>%
ggplot(aes(age, share))+
geom_point()+
theme_bw()+
geom_line(data = fortify(fit), aes(x = age, y = .fitted), color = pronoun)
View(chi_eng)
fit_fra <- fit <- lmer(share ~ age + pronoun + (1|childname), data = chi_fra)
summary(fit_fra)
qqnorm(lm(share ~ age + pronoun, data = chi_eng )$residuals)
summary(lm(share ~ age + pronoun, data = chi_eng ))
fit_eng <- lm(share ~ age + pronoun + (1|childname), data = chi_eng)
summary(lm(share ~ age + pronoun, data = chi_fra))
fit_fra <- fit <- lmer(share ~ age + pronoun + (1|childname), data = chi_fra)
summary(fit_fra)
rm(fit)
View(fit_fra)
pron_eng %>%
filter(participant == 'CHI') %>%
filter(pronoun != '3') %>%
select(-path) -> chi_eng
fit_eng <- lmer(share ~ age + pronoun + (1|childname), data = chi_eng)
summary(fit_eng)
View(chi_fra)
save.image("C:/My/studies/UIT/FLA/code/FLA/FLA.RData")
fra %>%
filter(age < 40 & age > 20) %>%
gather('pronoun', 'share', 7:16) -> pron_fra
library(tidyverse)
library(tidyr)
library(lmerTest)
library(lme4)
fra %>%
filter(age < 40 & age > 20) %>%
gather('pronoun', 'share', 7:16) -> pron_fra
View(chi_fra)
View(children_fra)
View(pron_fra)
pron_eng %>%
filter(participant == 'CHI') %>%
filter(pronoun != '3') %>%
select(-path) -> chi_eng
pron_fra %>%
filter(participant == 'CHI') %>%
select(-path) -> chi_fra
pron_eng %>%
mutate(age = floor(age, share)) %>%
spread(age, ) -> chi_eng
pron_eng %>%
mutate(age = floor(age)) %>%
spread(age, share) -> chi_eng
fra <- read_csv('C:/My/studies/UIT/FLA/code/FLA/result_french_personal.csv')
eng <- read_csv('C:/My/studies/UIT/FLA/code/FLA/result_english_personal.csv')
eng %>% # take relatively well-represented part (see commet below)
filter(age < 36 & age > 24) %>%
mutate(participant = ifelse(participant %in% adults, 'ADU', participant)) %>%
filter(participant == 'ADU' | participant == 'CHI') -> eng
eng %>%
mutate(`3` = `3sgF` + `3sgM` + `3sgN`+`3pl`) -> eng
eng %>%
filter(participant == 'CHI') %>%
gather('pronoun', 'share', 7:14) %>%
spread('age','share') %>%
filter(pronoun == '1sg') %>%
View()
eng %>%
filter(participant == 'CHI') %>%
gather('pronoun', 'share', 7:14) %>%
mutate(age = floor(age)) %>%
spread('age','share') %>%
filter(pronoun == '1sg') %>%
View()
eng %>%
filter(participant == 'CHI') %>%
gather('pronoun', 'share', 7:14) %>%
mutate(age = floor(age)) %>%
spread('age','share') %>%
View()
eng %>%
filter(participant == 'CHI') %>%
gather('pronoun', 'share', 7:14) %>%
mutate(age = floor(age)) %>%
spread('age','share') %>%
write.csv('spread_pronoun_eng.csv')
fra <- read_csv('C:/My/studies/UIT/FLA/code/FLA/result_french_personal.csv')
#  representation issues
fra %>% # sample size by age
filter(participant == 'CHI') %>%
select(age) %>%
mutate(age = round(age)) %>%
group_by(age) %>%
summarize(n = n()) -> ages
#  representation issues
fra %>% # sample size by age
filter(participant == 'CHI') %>%
select(age) %>%
mutate(age = floor(age)) %>%
group_by(age) %>%
summarize(n = n()) -> ages
fra %>%
filter(age < 35 & age > 25) %>%
gather('pronoun', 'share', 7:16) -> pron_fra
pron_fra %>%
filter(participant == 'CHI') %>%
spread('age','share') %>%
View()
fra %>%
filter(age < 35 & age > 25) %>%
mutate(age = floor(age)) %>%
gather('pronoun', 'share', 7:16) -> pron_fra
pron_fra %>%
filter(participant == 'CHI') %>%
mutate(age = floor(age)) %>%
spread('age','share') %>%
View()
pron_fra %>%
filter(participant == 'CHI') %>%
mutate(age = floor(age)) %>%
spread('age','share') %>%
write.csv('spread_pronoun_fra.csv')
View(chi_fra)
qqnorm(lm(share ~ age + pronoun, data = chi_fra)$residuals)
library(tidyverse)
fit_eng <- lmer(share ~ age + pronoun + (1|childname), data = chi_eng)
summary(fit_eng)
fit_eng <- lmer(share ~ age*pronoun + (1|childname), data = chi_eng)
summary(fit_eng)
pron_fra %>%
filter(participant == 'CHI') %>%
filter(pronoun != 'on') %>%
filter(pronoun != 'y') %>%
select(-path) -> chi_fra
fit_fra <- fit <- lmer(share ~ age*pronoun + (1|childname), data = chi_fra)
summary(fit_fra)
pron_fra %>%
filter(participant == 'CHI') %>%
filter(pronoun != 'on') %>%
filter(pronoun != 'y') %>%
mutate(share = share*100) %>%
select(-path) -> chi_fra
fit_fra <- fit <- lmer(share ~ age*pronoun + (1|childname), data = chi_fra)
summary(fit_fra)
?relevel
pron_fra %>%
filter(participant == 'CHI') %>%
filter(pronoun != 'on') %>%
filter(pronoun != 'y') %>%
mutate(share = share*100) %>%
mutate(pronoun = relevel(pronoun, '1sg',)) %>%
select(-path) -> chi_fra
pron_fra %>%
filter(participant == 'CHI') %>%
filter(pronoun != 'on') %>%
filter(pronoun != 'y') %>%
mutate(share = share*100) %>%
mutate(pronoun = relevel(as.factor(pronoun), '1sg',)) %>%
select(-path) -> chi_fra
fit_fra <- fit <- lmer(share ~ age*pronoun + (1|childname), data = chi_fra)
summary(fit_fra)
pron_fra %>%
filter(participant == 'CHI') %>%
filter(pronoun != 'on') %>%
filter(pronoun != 'y') %>%
filter(pronoun != '2') %>%
filter(pronoun != '3') %>%
mutate(share = share*100) %>%
mutate(pronoun = relevel(as.factor(pronoun), '1sg',)) %>%
select(-path) -> chi_fra
fit_fra <- fit <- lmer(share ~ age*pronoun + (1|childname), data = chi_fra)
summary(fit_fra)
pron_fra %>%
filter(participant == 'CHI') %>%
mutate(pronoun = ifelse(pronoun=='1sg'|pronoun=='1pl','1', pronoun)) %>%
filter(pronoun == '2' | pronoun == '1' | pronoun == '3') %>%
mutate(share = share*100) %>%
mutate(pronoun = relevel(as.factor(pronoun), '1sg',)) %>%
select(-path) -> chi_fra
pron_fra %>%
filter(participant == 'CHI') %>%
mutate(pronoun = ifelse(pronoun=='1sg'|pronoun=='1pl','1', pronoun)) %>%
filter(pronoun == '2' | pronoun == '1' | pronoun == '3') %>%
mutate(share = share*100) %>%
mutate(pronoun = relevel(as.factor(pronoun), '1',)) %>%
select(-path) -> chi_fra
adults <- c('MOT',
'FAT', 'DAD',
'INV', 'INT',
'GRA', 'GDM', 'GRM', 'MAM', 'NAN',
'GRN', 'GDF', 'GRF',
'DOC', 'OBS', 'HUS', 'MAN', 'MRS', 'NEI', 'OTH',
'UNC',
'AUN', 'AUT')
fra <- read_csv('C:/My/studies/UIT/FLA/code/FLA/result_french_personal.csv')
#  representation issues
fra %>% # sample size by age
filter(participant == 'CHI') %>%
select(age) %>%
mutate(age = floor(age)) %>%
group_by(age) %>%
summarize(n = n()) -> ages
fra %>%
mutate(`2` = `2sg` + `2pl`,
`3` = `3sg` + `3pl`) -> fra
fra %>%
filter(age < 35 & age > 25) %>%
gather('pronoun', 'share', 7:16) -> pron_fra
pron_fra %>%
filter(participant == 'CHI') %>%
mutate(pronoun = ifelse(pronoun=='1sg'|pronoun=='1pl','1', pronoun)) %>%
filter(pronoun == '2' | pronoun == '1' | pronoun == '3') %>%
mutate(share = share*100) %>%
mutate(pronoun = relevel(as.factor(pronoun), '1',)) %>%
select(-path) -> chi_fra
fit_fra <- fit <- lmer(share ~ age*pronoun + (1|childname), data = chi_fra)
summary(fit_fra)
fra %>%
filter(age < 35 & age > 25) %>%
gather('pronoun', 'share', 7:16) -> pron_fra
pron_fra %>%
filter(participant == 'CHI') %>%
mutate(pronoun = ifelse(pronoun == '1sg'|pronoun == '2sg'|pronoun == '3sg','1', '2')) -> chi_fra
fit_fra <- fit <- lmer(share ~ age*pronoun + (1|childname), data = chi_fra)
summary(fit_fra)
pron_fra %>%
filter(participant == 'CHI') %>%
mutate(pronoun = ifelse(pronoun == '1sg'|pronoun == '2sg'|pronoun == '3sg','sg', 'pl')) -> chi_fra
fit_fra <- fit <- lmer(share ~ age*pronoun + (1|childname), data = chi_fra)
summary(fit_fra)
pron_fra %>%
filter(participant == 'CHI') %>%
mutate(share = share*100) %>%
mutate(pronoun = ifelse(pronoun == '1sg'|pronoun == '2sg'|pronoun == '3sg','sg', 'pl')) -> chi_fra
fit_fra <- fit <- lmer(share ~ age*pronoun + (1|childname), data = chi_fra)
summary(fit_fra)
pron_fra %>%
filter(participant == 'CHI') %>%
mutate(share = share*100) %>%
mutate(pronoun = ifelse(pronoun == '1sg'|pronoun == '2sg'|pronoun == '3sg','1', '2')) -> chi_fra
fit_fra <- fit <- lmer(share ~ age*pronoun + (1|childname), data = chi_fra)
summary(fit_fra)
pron_eng %>%
filter(participant == 'CHI') %>%
mutate(pronoun = ifelse(pronoun=='1sg'|pronoun=='1pl','1', pronoun)) %>%
filter(pronoun == '2' | pronoun == '1' | pronoun == '3') %>%
mutate(share == share*100) %>%
select(-path) -> chi_eng
fit_eng <- lmer(share ~ age*pronoun + (1|childname), data = chi_eng)
summary(fit_eng)
pron_eng %>%
filter(participant == 'CHI') %>%
mutate(pronoun = ifelse(pronoun=='1sg'|pronoun=='1pl','1', pronoun)) %>%
mutate(pronoun = ifelse(pronoun=='3sgF'|pronoun=='3sgN'|pronoun=='3sgM'|pronoun=='3pl','1', pronoun)) %>%
filter(pronoun == '2' | pronoun == '1' | pronoun == '3') %>%
mutate(share == share*100) %>%
select(-path) -> chi_eng
fit_eng <- lmer(share ~ age*pronoun + (1|childname), data = chi_eng)
summary(fit_eng)
pron_eng %>%
filter(participant == 'CHI') %>%
mutate(pronoun = ifelse(pronoun=='1sg'|pronoun=='1pl','1', pronoun)) %>%
mutate(pronoun = ifelse(pronoun=='3sgF'|pronoun=='3sgN'|pronoun=='3sgM'|pronoun=='3pl','3', pronoun)) %>%
filter(pronoun == '2' | pronoun == '1' | pronoun == '3') %>%
mutate(share == share*100) %>%
select(-path) -> chi_eng
fit_eng <- lmer(share ~ age*pronoun + (1|childname), data = chi_eng)
summary(fit_eng)
pron_eng %>%
mutate(pronoun = ifelse(pronoun == '1sg'|pronoun == '2sg'|pronoun=='3sgF'|pronoun=='3sgN'|pronoun == '3sgM','sg', 'pl')) %>%
mutate(share = share*100) -> chi_eng
fit_eng <- lmer(share ~ age*pronoun + (1|childname), data = chi_eng)
summary(fit_eng)
pron_fra %>%
filter(participant == 'CHI') %>%
mutate(share = share*100) %>%
mutate(pronoun = ifelse(pronoun=='1sg'|pronoun=='1pl','1', pronoun)) %>%
filter(pronoun == '2' | pronoun == '1' | pronoun == '3') -> comparison_fra
pron_fra %>%
filter(participant == 'CHI') %>%
mutate(share = share*100) %>%
mutate(pronoun = ifelse(pronoun=='1sg'|pronoun=='1pl','1', pronoun)) %>%
filter(pronoun == '2' | pronoun == '1' | pronoun == '3') %>%
select(-path)-> comparison_fra
pron_eng %>%
filter(participant == 'CHI') %>%
mutate(pronoun = ifelse(pronoun=='1sg'|pronoun=='1pl','1', pronoun)) %>%
mutate(pronoun = ifelse(pronoun=='3sgF'|pronoun=='3sgN'|pronoun=='3sgM'|pronoun=='3pl','3', pronoun)) %>%
filter(pronoun == '2' | pronoun == '1' | pronoun == '3') %>%
mutate(share == share*100) %>%
select(-path) -> comparison_eng
View(comparison_eng)
View(comparison_fra)
comparison_eng %>%
filter(pronoun == '2') %>%
group_by(childname) -> comparison_eng_2
comparison_fra %>%
filter(pronoun == '2') %>%
group_by(childname) -> comparison_fra_2
comparison_2 <- cbind(comparison_eng_2, comparison_fra_2)
comparison_2 <- rbind(comparison_eng_2, comparison_fra_2)
View(comparison_2)
comparison_eng %>%
filter(pronoun == '2') %>%
mutate(languge == 'eng') %>%
group_by(childname) -> comparison_eng_2
comparison_fra %>%
filter(pronoun == '2') %>%
mutate(languge == 'fra') %>%
group_by(childname) -> comparison_fra_2
comparison_2 <- rbind(comparison_eng_2, comparison_fra_2)
fit_comp_2 <- lmer(share ~ age*language + (1|childname), data = chi_eng)
fit_comp_2 <- lmer(share ~ age*languge + (1|childname), data = chi_eng)
comparison_fra %>%
filter(pronoun == '2') %>%
mutate(languge == 'fra') %>%
mutate(age = floor(age)) %>%
group_by(childname) -> comparison_fra_2
comparison_eng %>%
filter(pronoun == '2') %>%
mutate(languge == 'eng') %>%
mutate(age = floor(age)) %>%
group_by(childname) -> comparison_eng_2
fit_comp_2 <- lmer(share ~ age*languge + (1|childname), data = chi_eng)
summary(fit_comp_2)
fit_comp_2 <- lmer(share ~ age+languge + (1|childname), data = chi_eng)
fit_comp_2 <- lmer(share ~ age*languge + (1|childname), data = chi_eng)
comparison_fra %>%
filter(pronoun == '2') %>%
mutate(languge == 'fra') %>%
group_by(childname) -> comparison_fra_2
comparison_eng %>%
filter(pronoun == '2') %>%
mutate(languge == 'eng') %>%
group_by(childname) -> comparison_eng_2
comparison_2 <- rbind(comparison_eng_2, comparison_fra_2)
fit_comp_2 <- lmer(share ~ age*languge + (1|childname), data = chi_eng)
fit_comp_2 <- lmer(share ~ age*languge + (1|childname), data = comparison_2)
summary(fit_comp_2)
comparison_eng %>%
filter(pronoun == '2') %>%
mutate(languge == 'eng') %>%
group_by(childname) -> comparison_eng_2
comparison_fra %>%
filter(pronoun == '2') %>%
mutate(languge == 'fra') %>%
group_by(childname) -> comparison_fra_2
comparison_2 <- rbind(comparison_eng_2, comparison_fra_2)
fit_comp_2 <- lmer(share ~ age*languge + (1|childname), data = comparison_2)
summary(fit_comp_2)
comparison_fra %>%
filter(pronoun == '2') %>%
mutate(languge = 'fra') %>%
group_by(childname) -> comparison_fra_2
comparison_eng %>%
filter(pronoun == '2') %>%
mutate(languge = 'eng') %>%
group_by(childname) -> comparison_eng_2
comparison_2 <- rbind(comparison_eng_2, comparison_fra_2)
fit_comp_2 <- lmer(share ~ age*languge + (1|childname), data = comparison_2)
summary(fit_comp_2)
pron_fra %>%
filter(participant == 'CHI') %>%
mutate(share = share*100) %>%
mutate(pronoun = ifelse(pronoun=='1sg'|pronoun=='1pl','1', pronoun)) %>%
filter(pronoun == '2' | pronoun == '1' | pronoun == '3') %>%
select(-path)-> comparison_fra
pron_eng %>%
filter(participant == 'CHI') %>%
mutate(pronoun = ifelse(pronoun=='1sg'|pronoun=='1pl','1', pronoun)) %>%
mutate(pronoun = ifelse(pronoun=='3sgF'|pronoun=='3sgN'|pronoun=='3sgM'|pronoun=='3pl','3', pronoun)) %>%
filter(pronoun == '2' | pronoun == '1' | pronoun == '3') %>%
mutate(share == share*100) %>%
select(-path) -> comparison_eng
pron_fra %>%
filter(participant == 'CHI') %>%
mutate(share = share*100) %>%
mutate(pronoun = ifelse(pronoun == 'y'|pronoun=='on'|pronoun == '1sg'|pronoun == '2sg'|pronoun == '3sg','sg', 'pl')) -> comp_fra_nub
View(comp_fra_nub)
rm(comp_fra_nub)
pron_fra %>%
filter(participant == 'CHI') %>%
mutate(share = share*100) %>%
mutate(pronoun = ifelse(pronoun == 'y'|pronoun=='on'|pronoun == '1sg'|pronoun == '2sg'|pronoun == '3sg','sg', 'pl')) -> comp_fra_num
pron_eng %>%
filter(participant == 'CHI') %>%
mutate(share == share*100) %>%
mutate(pronoun = ifelse(pronoun == '1sg'|pronoun == '2sg'|pronoun == '3sg','sg', 'pl')) -> comp_eng_num
comparison_num <- rbind(comp_eng_num, comp_fra_num)
View(comp_eng_num)
View(comp_fra_num)
View(comp_fra_num)
View(comp_eng_num)
%>%
select(-path)
pron_fra %>%
filter(participant == 'CHI') %>%
mutate(share = share*100) %>%
mutate(pronoun = ifelse(pronoun == 'y'|pronoun=='on'|pronoun == '1sg'|pronoun == '2sg'|pronoun == '3sg','sg', 'pl')) -> comp_fra_num
pron_fra %>%
filter(participant == 'CHI') %>%
mutate(share = share*100) %>%
mutate(pronoun = ifelse(pronoun == 'y'|pronoun=='on'|pronoun == '1sg'|pronoun == '2sg'|pronoun == '3sg','sg', 'pl')) %>%
select(-path) -> comp_fra_num
pron_fra %>%
filter(participant == 'CHI') %>%
mutate(share = share*100) %>%
mutate(pronoun = ifelse(pronoun == 'y'|pronoun=='on'|pronoun == '1sg'|pronoun == '2sg'|pronoun == '3sg','sg', 'pl')) %>%
select(-path) -> comp_fra_num
pron_eng %>%
filter(participant == 'CHI') %>%
mutate(share == share*100) %>%
mutate(pronoun = ifelse(pronoun == '1sg'|pronoun == '2sg'|pronoun == '3sg','sg', 'pl')) %>%
select(-path) -> comp_eng_num
comparison_num <- rbind(comp_eng_num, comp_fra_num)
View(comp_eng_num)
View(comp_fra_num)
View(comp_eng_num)
View(comp_fra_num)
pron_eng %>%
filter(participant == 'CHI') %>%
mutate(share == share*100) %>%
mutate(pronoun = ifelse(pronoun == '1sg'|pronoun == '2sg'|pronoun == '3sg','sg', 'pl')) %>%
select(-path, -`share == share*100`) -> comp_eng_num
pron_eng %>%
filter(participant == 'CHI') %>%
mutate(share == share*100) %>%
mutate(pronoun = ifelse(pronoun == '1sg'|pronoun == '2sg'|pronoun == '3sg','sg', 'pl')) %>%
select(-path, -8) -> comp_eng_num
comparison_num <- rbind(comp_eng_num, comp_fra_num)
pron_eng %>%
filter(participant == 'CHI') %>%
mutate(share == share*100) %>%
mutate(pronoun = ifelse(pronoun == '1sg'|pronoun == '2sg'|pronoun == '3sg','sg', 'pl')) %>%
select(-path, -8) -> comp_eng_num
pron_eng %>%
filter(participant == 'CHI') %>%
mutate(share == share*100) %>%
mutate(pronoun = ifelse(pronoun == '1sg'|pronoun == '2sg'|pronoun == '3sg','sg', 'pl')) %>%
select(-path) %>%
select(1:7)-> comp_eng_num
View(comp_eng_num)
comparison_num <- rbind(comp_eng_num, comp_fra_num)
fit_comp_num <- lmer(share ~ age*pronoun + (1|childname), data = comparison_num)
summary(fit_comp_num)
